#Twitter ë°ì´í„° ìˆ˜ì§‘í•˜ê¸°

elasticsearch site

<https://www.elastic.co/guide/en/logstash/current/plugins-inputs-twitter.html>

```yaml
input {
  twitter {
      consumer_key => "abn2I1hzwIVQItsqJfxDbtzTu"
      consumer_secret => "KY7Rvo8ub8PuSnrVd6oXt78mmMbYw3LBelRezZ919iNnlsVtap"
      oauth_token => "1116880164212731904-Kge0GuZFkpeUYAN0RZ8tmM999nPn0w"
      oauth_token_secret => "ZvZSfNtI8hS1gSm1vl0v9KLBLzqCMm932DkUlswKiRd1E"
      keywords => [""]
      full_tweet => true
  }
}
filter {

}
output {
  stdout { codec => dots }
  elasticsearch {
    hosts => "http://127.0.0.1:9200"
    index => "twitters"
  }
}
```

ëª¨ë“  ë°ì´í„°ë¥¼ ê°€ì§€ê³  ì˜¤ë ¤ê³ í–ˆì§€ë§Œ, í‚¤ì›Œë“œê°€ ìˆì–´ì•¼í•œë‹¤.!! 

Keywords ì— ë¬¸ìë¥¼ ì ì–´ì¤˜ì•¼ë§Œ ì‹¤í–‰ì´ ë¨ 



ìœ„ì™€ ê°™ì´ íŠ¸ìœ„í„°ë¥¼ ê°€ì§€ê³  ì˜¤ë©´ ì•„ë˜ì™€ ê°™ì´ documentë“¤ì„ ì–»ì„ìˆ˜ ìˆë‹¤

```json
{  
   "_index":"twitter_ko",
   "_type":"doc",
   "_id":"6EKUIWoBzy95F4vZRn2i",
   "_version":1,
   "_score":1,
   "_source":{  
      "favorited":false,
      "extended_entities":{  
         "media":[  
            {  
               "type":"photo",
               "sizes":{  
                  "thumb":{  
                     "w":150,
                     "h":150,
                     "resize":"crop"
                  },
                  "small":{  
                     "w":454,
                     "h":680,
                     "resize":"fit"
                  },
                  "medium":{  
                     "w":802,
                     "h":1200,
                     "resize":"fit"
                  },
                  "large":{  
                     "w":1368,
                     "h":2048,
                     "resize":"fit"
                  }
               },
               "indices":[  
                  94,
                  117
               ],
               "source_user_id":4484959873,
               "source_status_id_str":"1117744385750257664",
               "id_str":"1117744356922839040",
               "media_url":"http://pbs.twimg.com/media/D4MGkhAVUAAmoHk.jpg",
               "media_url_https":"https://pbs.twimg.com/media/D4MGkhAVUAAmoHk.jpg",
               "expanded_url":"https://twitter.com/blvcksnow_twt/status/1117744385750257664/photo/1",
               "url":"https://t.co/qDQy2aIyTD",
               "display_url":"pic.twitter.com/qDQy2aIyTD",
               "source_user_id_str":"4484959873",
               "source_status_id":1117744385750257700,
               "id":1117744356922839000
            },
            {  
               "type":"photo",
               "sizes":{  
                  "thumb":{  
                     "w":150,
                     "h":150,
                     "resize":"crop"
                  },
                  "small":{  
                     "w":680,
                     "h":453,
                     "resize":"fit"
                  },
                  "medium":{  
                     "w":1200,
                     "h":799,
                     "resize":"fit"
                  },
                  "large":{  
                     "w":2048,
                     "h":1364,
                     "resize":"fit"
                  }
               },
               "indices":[  
                  94,
                  117
               ],
               "source_user_id":4484959873,
               "source_status_id_str":"1117744385750257664",
               "id_str":"1117744370759786498",
               "media_url":"http://pbs.twimg.com/media/D4MGlUjUYAIEb2y.jpg",
               "media_url_https":"https://pbs.twimg.com/media/D4MGlUjUYAIEb2y.jpg",
               "expanded_url":"https://twitter.com/blvcksnow_twt/status/1117744385750257664/photo/1",
               "url":"https://t.co/qDQy2aIyTD",
               "display_url":"pic.twitter.com/qDQy2aIyTD",
               "source_user_id_str":"4484959873",
               "source_status_id":1117744385750257700,
               "id":1117744370759786500
            }
         ]
      },
      "in_reply_to_screen_name":null,
      "coordinates":null,
      "contributors":null,
      "in_reply_to_user_id_str":null,
      "in_reply_to_status_id":null,
      "id_str":"1117809394849320960",
      "retweeted_status":{  
         "favorited":false,
         "extended_entities":{  
            "media":[  
               {  
                  "id_str":"1117744356922839040",
                  "media_url":"http://pbs.twimg.com/media/D4MGkhAVUAAmoHk.jpg",
                  "media_url_https":"https://pbs.twimg.com/media/D4MGkhAVUAAmoHk.jpg",
                  "expanded_url":"https://twitter.com/blvcksnow_twt/status/1117744385750257664/photo/1",
                  "type":"photo",
                  "sizes":{  
                     "thumb":{  
                        "w":150,
                        "h":150,
                        "resize":"crop"
                     },
                     "small":{  
                        "w":454,
                        "h":680,
                        "resize":"fit"
                     },
                     "medium":{  
                        "w":802,
                        "h":1200,
                        "resize":"fit"
                     },
                     "large":{  
                        "w":1368,
                        "h":2048,
                        "resize":"fit"
                     }
                  },
                  "indices":[  
                     75,
                     98
                  ],
                  "url":"https://t.co/qDQy2aIyTD",
                  "display_url":"pic.twitter.com/qDQy2aIyTD",
                  "id":1117744356922839000
               },
               {  
                  "id_str":"1117744370759786498",
                  "media_url":"http://pbs.twimg.com/media/D4MGlUjUYAIEb2y.jpg",
                  "media_url_https":"https://pbs.twimg.com/media/D4MGlUjUYAIEb2y.jpg",
                  "expanded_url":"https://twitter.com/blvcksnow_twt/status/1117744385750257664/photo/1",
                  "type":"photo",
                  "sizes":{  
                     "thumb":{  
                        "w":150,
                        "h":150,
                        "resize":"crop"
                     },
                     "small":{  
                        "w":680,
                        "h":453,
                        "resize":"fit"
                     },
                     "medium":{  
                        "w":1200,
                        "h":799,
                        "resize":"fit"
                     },
                     "large":{  
                        "w":2048,
                        "h":1364,
                        "resize":"fit"
                     }
                  },
                  "indices":[  
                     75,
                     98
                  ],
                  "url":"https://t.co/qDQy2aIyTD",
                  "display_url":"pic.twitter.com/qDQy2aIyTD",
                  "id":1117744370759786500
               }
            ]
         },
         "in_reply_to_screen_name":null,
         "coordinates":null,
         "contributors":null,
         "in_reply_to_user_id_str":null,
         "in_reply_to_status_id":null,
         "id_str":"1117744385750257664",
         "reply_count":0,
         "geo":null,
         "retweet_count":155,
         "user":{  
            "followers_count":98563,
            "profile_banner_url":"https://pbs.twimg.com/profile_banners/4484959873/1554220599",
            "time_zone":null,
            "default_profile_image":false,
            "following":null,
            "profile_image_url":"http://pbs.twimg.com/profile_images/1116933342539026432/URF3iFM7_normal.jpg",
            "description":"@BTS_twt ğ™·ğš€/ğ™¿ğšğ™´ ğ™¿ğ™¸ğ™²ğš‚ ğš…ğ™¸ğ™³ ğ™°ğ™½ğ™³ ğ™½ğ™´ğš†ğš‚ Backup acc @blacksnow_twt",
            "translator_type":"none",
            "protected":false,
            "statuses_count":19080,
            "profile_link_color":"E81C4F",
            "id_str":"4484959873",
            "screen_name":"blvcksnow_twt",
            "contributors_enabled":false,
            "follow_request_sent":null,
            "name":"ë°©íƒ„ì†Œë…„ë‹¨ HQ PICS â˜¯",
            "location":"BLVCKSNOW FAIRYDOOLY ZASEORIN",
            "is_translator":false,
            "listed_count":360,
            "profile_sidebar_fill_color":"000000",
            "default_profile":false,
            "profile_sidebar_border_color":"000000",
            "favourites_count":17640,
            "profile_background_tile":false,
            "profile_text_color":"000000",
            "friends_count":11,
            "verified":false,
            "profile_background_color":"000000",
            "notifications":null,
            "profile_background_image_url_https":"https://abs.twimg.com/images/themes/theme1/bg.png",
            "created_at":"Mon Dec 07 10:15:38 +0000 2015",
            "profile_background_image_url":"http://abs.twimg.com/images/themes/theme1/bg.png",
            "profile_use_background_image":false,
            "url":null,
            "lang":"en",
            "profile_image_url_https":"https://pbs.twimg.com/profile_images/1116933342539026432/URF3iFM7_normal.jpg",
            "geo_enabled":true,
            "id":4484959873,
            "utc_offset":null
         },
         "quote_count":3,
         "in_reply_to_status_id_str":null,
         "filter_level":"low",
         "possibly_sensitive":false,
         "retweeted":false,
         "source":"<a href="         http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>",
         "truncated":false,
         "display_text_range":[  
            0,
            74
         ],
         "is_quote_status":false,
         "favorite_count":912,
         "entities":{  
            "symbols":[  

            ],
            "urls":[  

            ],
            "hashtags":[  
               {  
                  "indices":[  
                     28,
                     31
                  ],
                  "text":"ìŠˆê°€"
               },
               {  
                  "indices":[  
                     32,
                     37
                  ],
                  "text":"SUGA"
               },
               {  
                  "indices":[  
                     38,
                     41
                  ],
                  "text":"ìœ¤ê¸°"
               },
               {  
                  "indices":[  
                     42,
                     46
                  ],
                  "text":"BTS"
               }
            ],
            "media":[  
               {  
                  "id_str":"1117744356922839040",
                  "media_url":"http://pbs.twimg.com/media/D4MGkhAVUAAmoHk.jpg",
                  "media_url_https":"https://pbs.twimg.com/media/D4MGkhAVUAAmoHk.jpg",
                  "expanded_url":"https://twitter.com/blvcksnow_twt/status/1117744385750257664/photo/1",
                  "type":"photo",
                  "sizes":{  
                     "thumb":{  
                        "w":150,
                        "h":150,
                        "resize":"crop"
                     },
                     "small":{  
                        "w":454,
                        "h":680,
                        "resize":"fit"
                     },
                     "medium":{  
                        "w":802,
                        "h":1200,
                        "resize":"fit"
                     },
                     "large":{  
                        "w":1368,
                        "h":2048,
                        "resize":"fit"
                     }
                  },
                  "indices":[  
                     75,
                     98
                  ],
                  "url":"https://t.co/qDQy2aIyTD",
                  "display_url":"pic.twitter.com/qDQy2aIyTD",
                  "id":1117744356922839000
               }
            ],
            "user_mentions":[  
               {  
                  "id_str":"335141638",
                  "indices":[  
                     47,
                     55
                  ],
                  "name":"ë°©íƒ„ì†Œë…„ë‹¨",
                  "id":335141638,
                  "screen_name":"BTS_twt"
               }
            ]
         },
         "created_at":"Mon Apr 15 11:00:02 +0000 2019",
         "place":null,
         "text":"190415 ì¸ì²œ ì…êµ­ Welcome backğŸ˜Š #ìŠˆê°€ #SUGA #ìœ¤ê¸° #BTS @BTS_twt Cr. mysugacat309 https://t.co/qDQy2aIyTD",
         "in_reply_to_user_id":null,
         "lang":"ko",
         "id":1117744385750257700
      },
      "geo":null,
      "reply_count":0,
      "retweet_count":0,
      "user":{  
         "followers_count":115,
         "profile_banner_url":"https://pbs.twimg.com/profile_banners/1084884850585321482/1551547919",
         "time_zone":null,
         "default_profile_image":false,
         "following":null,
         "profile_image_url":"http://pbs.twimg.com/profile_images/1114060697384640512/h5OnQa8N_normal.png",
         "description":"Army | medical student",
         "translator_type":"none",
         "protected":false,
         "statuses_count":18211,
         "profile_link_color":"1DA1F2",
         "id_str":"1084884850585321482",
         "screen_name":"ThanksBTS6",
         "contributors_enabled":false,
         "follow_request_sent":null,
         "name":"BTS stan ğŸ‘©ğŸ»â€âš•ï¸ğŸŒ¸ğŸ’œğŸ€",
         "location":null,
         "is_translator":false,
         "listed_count":0,
         "profile_sidebar_fill_color":"DDEEF6",
         "default_profile":true,
         "profile_sidebar_border_color":"C0DEED",
         "favourites_count":1995,
         "profile_background_tile":false,
         "profile_text_color":"333333",
         "friends_count":101,
         "verified":false,
         "profile_background_color":"F5F8FA",
         "notifications":null,
         "profile_background_image_url_https":"",
         "created_at":"Mon Jan 14 18:47:59 +0000 2019",
         "profile_background_image_url":"",
         "profile_use_background_image":true,
         "url":null,
         "lang":"en",
         "profile_image_url_https":"https://pbs.twimg.com/profile_images/1114060697384640512/h5OnQa8N_normal.png",
         "geo_enabled":false,
         "id":1084884850585321500,
         "utc_offset":null
      },
      "quote_count":0,
      "in_reply_to_status_id_str":null,
      "filter_level":"low",
      "possibly_sensitive":false,
      "retweeted":false,
      "timestamp_ms":"1555341502283",
      "source":"<a href="      https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>",
      "truncated":false,
      "is_quote_status":false,
      "favorite_count":0,
      "entities":{  
         "symbols":[  

         ],
         "urls":[  

         ],
         "hashtags":[  
            {  
               "indices":[  
                  47,
                  50
               ],
               "text":"ìŠˆê°€"
            },
            {  
               "indices":[  
                  51,
                  56
               ],
               "text":"SUGA"
            },
            {  
               "indices":[  
                  57,
                  60
               ],
               "text":"ìœ¤ê¸°"
            },
            {  
               "indices":[  
                  61,
                  65
               ],
               "text":"BTS"
            }
         ],
         "media":[  
            {  
               "type":"photo",
               "sizes":{  
                  "thumb":{  
                     "w":150,
                     "h":150,
                     "resize":"crop"
                  },
                  "small":{  
                     "w":454,
                     "h":680,
                     "resize":"fit"
                  },
                  "medium":{  
                     "w":802,
                     "h":1200,
                     "resize":"fit"
                  },
                  "large":{  
                     "w":1368,
                     "h":2048,
                     "resize":"fit"
                  }
               },
               "indices":[  
                  94,
                  117
               ],
               "source_user_id":4484959873,
               "source_status_id_str":"1117744385750257664",
               "id_str":"1117744356922839040",
               "media_url":"http://pbs.twimg.com/media/D4MGkhAVUAAmoHk.jpg",
               "media_url_https":"https://pbs.twimg.com/media/D4MGkhAVUAAmoHk.jpg",
               "expanded_url":"https://twitter.com/blvcksnow_twt/status/1117744385750257664/photo/1",
               "url":"https://t.co/qDQy2aIyTD",
               "display_url":"pic.twitter.com/qDQy2aIyTD",
               "source_user_id_str":"4484959873",
               "source_status_id":1117744385750257700,
               "id":1117744356922839000
            }
         ],
         "user_mentions":[  
            {  
               "id_str":"4484959873",
               "indices":[  
                  3,
                  17
               ],
               "name":"ë°©íƒ„ì†Œë…„ë‹¨ HQ PICS â˜¯",
               "id":4484959873,
               "screen_name":"blvcksnow_twt"
            },
            {  
               "id_str":"335141638",
               "indices":[  
                  66,
                  74
               ],
               "name":"ë°©íƒ„ì†Œë…„ë‹¨",
               "id":335141638,
               "screen_name":"BTS_twt"
            }
         ]
      },
      "created_at":"Mon Apr 15 15:18:22 +0000 2019",
      "place":null,
      "@version":"1",
      "text":"RT @blvcksnow_twt: 190415 ì¸ì²œ ì…êµ­ Welcome backğŸ˜Š #ìŠˆê°€ #SUGA #ìœ¤ê¸° #BTS @BTS_twt Cr. mysugacat309 https://t.co/qDQy2aIyTD",
      "@timestamp":"2019-04-15T15:18:22.000Z",
      "in_reply_to_user_id":null,
      "lang":"ko",
      "id":1117809394849321000
   }
}
```







###elasticsearch filter

<https://www.elastic.co/guide/en/logstash/current/plugins-filters-elasticsearch.html>

```filter
if [type] == "end" {
   elasticsearch {
      hosts => ["es-server"]
      query => "type:start AND operation:%{[opid]}"
      fields => { "@timestamp" => "started" }
   }

   date {
      match => ["[started]", "ISO8601"]
      target => "[started]"
   }

   ruby {
      code => "event.set('duration_hrs', (event.get('@timestamp') - event.get('started')) / 3600)"
   }
}
```

ìœ„ì™€ ê°™ì´ filterì— elasticsearch ë¥¼ ì ëŠ”ë‹¤ ??



```json
filter{
  if [lang] == 'kr'{
      elasticsearch {
          hosts => "http://127.0.0.1:9200"
    	    index => kr_twitters
      }
  }
}
```

í•„í„°ì— ì ìœ¼ë‹ˆê¹Œ ë°ì´í„°ê°€ ì•ˆë“¤ì–´ê°„ë‹¤!! 





###logstash drop{} ??

<https://www.elastic.co/guide/en/logstash/current/plugins-filters-drop.html>

```yaml
filter{
  if [lang] != 'ko'{
     drop{}
  }
}
```

ìœ„ì˜ dropì„ ì‚¬ìš©í•´ì„œ ì•„ë˜ì™€ ê°™ì´ ì…ë ¥ì„ í•´ì£¼ë©´ lang: ko ë§Œ ê°€ì§€ê³  ì˜¤ê²Œëœë‹¤.

```yaml
input {
  twitter {
      consumer_key => "abn2I1hzwIVQItsqJfxDbtzTu"
      consumer_secret => "KY7Rvo8ub8PuSnrVd6oXt78mmMbYw3LBelRezZ919iNnlsVtap"
      oauth_token => "1116880164212731904-Kge0GuZFkpeUYAN0RZ8tmM999nPn0w"
      oauth_token_secret => "ZvZSfNtI8hS1gSm1vl0v9KLBLzqCMm932DkUlswKiRd1E"
      keywords => ["bts"]
      full_tweet => true
  }
}
filter {
  if [lang] != 'ko'{
    drop{}
  }

}
output {
   stdout{}
   elasticsearch{
     hosts => "http://127.0.0.1:9200"
     index => "twitter_ko"
   }
}

```



```yaml
input {
  twitter {
      consumer_key => "consumer_key"
      consumer_secret => "consumer_secret"
      oauth_token => "oauth_token"
      oauth_token_secret => "oauth_token_secret"
      keywords => ["bts"]
      full_tweet => true
  }
}
filter {
  if [lang] != 'ko'{
    drop{}
  }

}
output {
   stdout{}
   elasticsearch{
     hosts => "http://127.0.0.1:9200"
     index => "twitter_ko"
   }
}


```





### mapping

í•´ì•¼í• ì¼!! 

Lang: ko ë§Œ ê°€ì§€ê³ ì˜¤ê¸° , ì•„ë˜ì˜ ì£¼ì†Œì— ë§ì¶°ì„œ ë°ì´í„° íƒ€ì… í•„í„°ë§í•´ì„œ ë“¤ê³ ì˜¤ê¸° !! 

ë°ì´í„°ë¥¼ lang: ko ë§Œ  í•„í„°ë§í•œê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤ .

```json
{  
      "favorited":false,
      "extended_entities":{  },
      "in_reply_to_screen_name":null,
      "coordinates":null,
      "contributors":null,
      "in_reply_to_user_id_str":null,
      "in_reply_to_status_id":null,
      "id_str":"1117809394849320960",
      "retweeted_status":{  },
      "geo":null,
      "reply_count":0,
      "retweet_count":0,
      "user":{  },
      "quote_count":0,
      "in_reply_to_status_id_str":null,
      "filter_level":"low",
      "possibly_sensitive":false,
      "retweeted":false,
      "timestamp_ms":"1555341502283",
      "source":"<a href="      https://mobile.twitter.com" rel="nofollow">Twitter Web App</a>",
      "truncated":false,
      "is_quote_status":false,
      "favorite_count":0,
      "entities":{  },
      "created_at":"Mon Apr 15 15:18:22 +0000 2019",
      "place":null,
      "@version":"1",
      "text":"RT @blvcksnow_twt: 190415 ì¸ì²œ ì…êµ­ Welcome backğŸ˜Š #ìŠˆê°€ #SUGA #ìœ¤ê¸° #BTS @BTS_twt Cr. mysugacat309 https://t.co/qDQy2aIyTD",
      "@timestamp":"2019-04-15T15:18:22.000Z",
      "in_reply_to_user_id":null,
      "lang":"ko",
      "id":1117809394849321000
   }
```



###ì´ì œ í•„ìš”ì—†ëŠ” í•„ë“œë“¤ì„ ì œê±° í•´ë³´ì!! 

ì¶”ê°€ í•œê²ƒ í•„í„°ë§ ì•„ë˜ì˜ í•„ë“œëŠ” ì œê±°ê°€ í• í•„ìš”ê°€ ìˆì–´ì„œ ì¶”ê°€í•œê²ƒì´ë‹¤.

```json
filter{
  mutate{
  	remove_field =>["extended_entities","possibly_sensitive","is_quote_status","entities","retweeted_status","in_reply_to_user_id_str","in_reply_to_status_id","in_reply_to_screen_name"]
	}
}
```

<https://www.elastic.co/guide/en/logstash/6.2/plugins-filters-mutate.html>



ê²°ê³¼ëŠ” ì˜ë‚˜ì˜¤ë„¤~~

```json
{
"_index": "twitter_ko_filter",
"_type": "doc",
"_id": "EuYGOGoBgAFZ-q-71dg9",
"_version": 1,
"_score": 1,
"_source": {
"lang": "ko",
"reply_count": 0,
"in_reply_to_status_id_str": null,
"created_at": "Fri Apr 19 23:55:27 +0000 2019",
"text": "RT @BTSLAB_twt: #PersonaUKNumber1 ë°©íƒ„ì†Œë…„ë‹¨ í•œêµ­ #kpop ê·¸ë£¹ìœ¼ë¡œ ìµœì´ˆë¡œ ğŸ‡¬ğŸ‡§ì˜êµ­ UKì°¨íŠ¸ ê°€ì¥ ë†’ì€ ìˆœìœ„ ì•¨ë²”ì°¨íŠ¸ 1ìœ„ğŸ†ì‹±ê¸€ì°¨íŠ¸ 13ìœ„ğŸ† @BTS_twt ì¶•í•˜í•©ë‹ˆë‹¤ğŸ‰ UK albums chart Top100ğŸ†• ğŸ¥‡#1â€¦",
"coordinates": null,
"place": null,
"retweet_count": 0,
"@version": "1",
"@timestamp": "2019-04-19T23:55:27.000Z",
"filter_level": "low",
"contributors": null,
"source": "<a href="http://twitter.com/download/iphone" rel="nofollow">Twitter for iPhone</a>",
"user": {
"utc_offset": null,
"profile_banner_url": "https://pbs.twimg.com/profile_banners/159380203/1554388750",
"lang": "en",
"profile_background_tile": false,
"follow_request_sent": null,
"profile_sidebar_border_color": "C0DEED",
"notifications": null,
"contributors_enabled": false,
"location": null,
"created_at": "Fri Jun 25 06:15:12 +0000 2010",
"profile_sidebar_fill_color": "DDEEF6",
"profile_text_color": "333333",
"is_translator": false,
"profile_image_url_https": "https://pbs.twimg.com/profile_images/1052558969963565056/fwnkja5U_normal.jpg",
"translator_type": "none",
"favourites_count": 19005,
"profile_background_image_url": "http://abs.twimg.com/images/themes/theme1/bg.png",
"profile_image_url": "http://pbs.twimg.com/profile_images/1052558969963565056/fwnkja5U_normal.jpg",
"name": "bella",
"profile_background_color": "C0DEED",
"followers_count": 413,
"profile_link_color": "1DA1F2",
"url": null,
"description": "ë°©íƒ„ë§Œì´ ë‚´ì„¸ìƒ~ğŸ’œBTSxARMY ì„ íŒ”=ë§íŒ” ê°‘ë‹ˆë‹¹ // ìš°ë¦¬ëª¨ë‘ í˜ë‚´ë³´ì•„ìš”ğŸ’ªğŸ”¥ ê³„ì •ì•ˆì •ì„ ìœ„í•´ íŒ”ë¡œì›Œ ëŠ˜ë¦¬ê³ ìˆìŠµë‹ˆë‹¤ ğŸ‘ @BTS_twt ìƒí™œí™” í•©ë‹ˆë‹¤~",
"protected": false,
"listed_count": 0,
"profile_background_image_url_https": "https://abs.twimg.com/images/themes/theme1/bg.png",
"statuses_count": 17535,
"profile_use_background_image": true,
"following": null,
"time_zone": null,
"id": 159380203,
"verified": false,
"geo_enabled": false,
"default_profile_image": false,
"friends_count": 503,
"default_profile": true,
"screen_name": "bella0825",
"id_str": "159380203"
},
"quote_count": 0,
"retweeted": false,
"timestamp_ms": "1555718127807",
"geo": null,
"favorited": false,
"id": 1119389076790972400,
"in_reply_to_user_id": null,
"favorite_count": 0,
"truncated": false,
"id_str": "1119389076790972416"
}
}
```



í™•ì‹¤íˆ í•„ìš”í•œ ë°ì´í„°ë¥¼ ì–»ê¸° ìœ„í•´ì„œ ë‹¤ë¥¸ í•„ë“œë¥¼ ë” ì‚­ì œ ë¶„ì„ì— í•„ìš”í•œ í•„ë“œë¥¼ ê³¨ë¼ë³´ì 

1. Text
2. Id ëŠ” userid ??
3. Create_at
4. retweet_count

```json
filter {
  if [lang] != 'ko'{
    drop{}
  }
  mutate{
        remove_field => ["extended_entities","possibly_sensitive","is_quote_status","entities","retweeted_status","in_reply_to_user_id_str","in_reply_to_status_id","in_reply_to_screen_name","in_reply_to_screen_name", "coordinates","contributors","in_reply_to_user_id_str","in_reply_to_status_id","id_str","retweeted_status","geo","reply_count","user","quote_count","in_reply_to_status_id_str","filter_level","possibly_sensitive","retweeted","timestamp_ms","source","truncated","is_quote_status","favorite_count","entities","place","in_reply_to_user_id"]
  }

  date {
    match => ["created_at", "yyyyMMddHHmmss"]
    timezone => "UTC"
    locale => "ko"
  }
}
```

ê·¸ë¦¬ê³  createatì€ date íƒ€ì…ìœ¼ë¡œ ì…ë ¥ì´ ë˜ì–´ì•¼í•˜ê¸° ë•Œë¬¸ì— ì‚¬ì „ì— ë°ì´íŠ¸íƒ€ì… í•„ë“œì— date íƒ€ì…ì„ ì¶”ê°€ í•´ì¤€ë‹¤.

```txt
An example of a tweetâ€™s date is:

"created_at": "Thu Jul 31 23:00:09 +0000 2014"
According to the pattern syntax, the tweet format is as follows:

"EEE MMM dd HH:mm:ss Z yyyy"
```

### íŠ¸ìœ„í„° ë°ì´í„° ê°€ì§€ê³ ì˜¤ê¸° ì¢…í•© 

1. ë¨¼ì € ë§µí•‘ bts_twitterë¡œ date í•„ë“œë¥¼ ë§Œë“¤ì–´ì£¼ê³  ì ìš© 

```json
PUT bts_twitter
{
  "mappings": {
    "_doc": {
      "properties": {
        "created_at": {
          "type": "date",
          "format": "EEE MMM dd HH:mm:ss Z yyy"
        },
        "text":{
          "type": "text"
        }
      }
    }
  }
}
```

2. logstash íŒŒì¼ 

```yml
es
input {
  twitter {
      consumer_key => "abn2I1hzwIVQItsqJfxDbtzTu"
      consumer_secret => "KY7Rvo8ub8PuSnrVd6oXt78mmMbYw3LBelRezZ919iNnlsVtap"
      oauth_token => "1116880164212731904-Kge0GuZFkpeUYAN0RZ8tmM999nPn0w"
      oauth_token_secret => "ZvZSfNtI8hS1gSm1vl0v9KLBLzqCMm932DkUlswKiRd1E"
      keywords => ["bts"]
      full_tweet => true
  }
}
filter {
  if [lang] != 'ko'{
    drop{}
  }
  mutate{
        remove_field => ["extended_entities","possibly_sensitive","is_quote_status","entities","retweeted_status","in_reply_to_user_id_str","in_reply_to_status_id","in_reply_to_screen_name","in_reply_to_screen_name", "coordinates","contributors","in_reply_to_user_id_str","in_reply_to_status_id","id_str","retweeted_status","geo","reply_count","user","quote_count","in_reply_to_status_id_str","filter_level","possibly_sensitive","retweeted","timestamp_ms","source","truncated","is_quote_status","favorite_count","entities","place","in_reply_to_user_id"]
  }
  date {
    match => ["created_at", "EEE MMM dd HH:mm:ss Z yyyy"]
    timezone => "UTC"
    locale => "ko"
  }
}
output {
   stdout{}
   elasticsearch{
     hosts => "http://127.0.0.1:9200"
     index => "bts_twitter"
     document_type => "_doc"
   }
}
```





ì°¸ê³  : <https://medium.com/@CMpoi/elasticsearch-defining-the-mapping-of-twitter-data-dafad0f50695>